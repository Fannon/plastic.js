<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: core/Element.js</title>
    
    
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"plastic.js API","disqus":"","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"","description":"","keyword":""}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">plastic.js API</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="plastic">
            <span class="title">
                <a href="plastic.html">plastic</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.elements"><a href="plastic.html#elements">elements</a></li>
            
                <li data-name="plastic.version"><a href="plastic.html#version">version</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="plastic.execute"><a href="plastic.html#execute">execute</a></li>
            
                <li data-name="plastic.msg"><a href="plastic.html#msg">msg</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="plastic.modules">
            <span class="title">
                <a href="plastic.modules.html">plastic.modules</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.modules.dependencies"><a href="plastic.modules.html#dependencies">dependencies</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="plastic.modules.registry">
            <span class="title">
                <a href="plastic.modules.registry.html">plastic.modules.registry</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.modules.registry.modules"><a href="plastic.modules.registry.html#modules">modules</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="plastic.modules.registry.add"><a href="plastic.modules.registry.html#add">add</a></li>
            
                <li data-name="plastic.modules.registry.get"><a href="plastic.modules.registry.html#get">get</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="plastic.options">
            <span class="title">
                <a href="plastic.options.html">plastic.options</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.options.debug"><a href="plastic.options.html#debug">debug</a></li>
            
                <li data-name="plastic.options.height"><a href="plastic.options.html#height">height</a></li>
            
                <li data-name="plastic.options.timeout"><a href="plastic.options.html#timeout">timeout</a></li>
            
                <li data-name="plastic.options.width"><a href="plastic.options.html#width">width</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="plastic.Element">
            <span class="title">
                <a href="plastic.Element.html">plastic.Element</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.Element#attr"><a href="plastic.Element.html#attr">attr</a></li>
            
                <li data-name="plastic.Element#attributes"><a href="plastic.Element.html#attributes">attributes</a></li>
            
                <li data-name="plastic.Element#dataModule"><a href="plastic.Element.html#dataModule">dataModule</a></li>
            
                <li data-name="plastic.Element#displayModule"><a href="plastic.Element.html#displayModule">displayModule</a></li>
            
                <li data-name="plastic.Element#el"><a href="plastic.Element.html#el">el</a></li>
            
                <li data-name="plastic.Element#queryModule"><a href="plastic.Element.html#queryModule">queryModule</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="plastic.Element#callDataParser"><a href="plastic.Element.html#callDataParser">callDataParser</a></li>
            
                <li data-name="plastic.Element#callDisplayModule"><a href="plastic.Element.html#callDisplayModule">callDisplayModule</a></li>
            
                <li data-name="plastic.Element#callQueryParser"><a href="plastic.Element.html#callQueryParser">callQueryParser</a></li>
            
                <li data-name="plastic.Element#createDisplayContainer"><a href="plastic.Element.html#createDisplayContainer">createDisplayContainer</a></li>
            
                <li data-name="plastic.Element#createMsgContainer"><a href="plastic.Element.html#createMsgContainer">createMsgContainer</a></li>
            
                <li data-name="plastic.Element#exec"><a href="plastic.Element.html#exec">exec</a></li>
            
                <li data-name="plastic.Element#getAttr"><a href="plastic.Element.html#getAttr">getAttr</a></li>
            
                <li data-name="plastic.Element#getEl"><a href="plastic.Element.html#getEl">getEl</a></li>
            
                <li data-name="plastic.Element#setEl"><a href="plastic.Element.html#setEl">setEl</a></li>
            
                <li data-name="plastic.Element#setRawData"><a href="plastic.Element.html#setRawData">setRawData</a></li>
            
                <li data-name="plastic.Element#validateModule"><a href="plastic.Element.html#validateModule">validateModule</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="plastic.ElementAttributes">
            <span class="title">
                <a href="plastic.ElementAttributes.html">plastic.ElementAttributes</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.ElementAttributes#attr"><a href="plastic.ElementAttributes.html#attr">attr</a></li>
            
                <li data-name="plastic.ElementAttributes#el"><a href="plastic.ElementAttributes.html#el">el</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="plastic.ElementAttributes#getAttr"><a href="plastic.ElementAttributes.html#getAttr">getAttr</a></li>
            
                <li data-name="plastic.ElementAttributes#getData"><a href="plastic.ElementAttributes.html#getData">getData</a></li>
            
                <li data-name="plastic.ElementAttributes#getOptions"><a href="plastic.ElementAttributes.html#getOptions">getOptions</a></li>
            
                <li data-name="plastic.ElementAttributes#getQuery"><a href="plastic.ElementAttributes.html#getQuery">getQuery</a></li>
            
                <li data-name="plastic.ElementAttributes#getSchema"><a href="plastic.ElementAttributes.html#getSchema">getSchema</a></li>
            
                <li data-name="plastic.ElementAttributes#getStyle"><a href="plastic.ElementAttributes.html#getStyle">getStyle</a></li>
            
                <li data-name="plastic.ElementAttributes#parse"><a href="plastic.ElementAttributes.html#parse">parse</a></li>
            
                <li data-name="plastic.ElementAttributes#validate"><a href="plastic.ElementAttributes.html#validate">validate</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="plastic.modules.data.AskJson">
            <span class="title">
                <a href="plastic.modules.data.AskJson.html">plastic.modules.data.AskJson</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.modules.data.AskJson#dataObj"><a href="plastic.modules.data.AskJson.html#dataObj">dataObj</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="plastic.modules.data.AskJson#execute"><a href="plastic.modules.data.AskJson.html#execute">execute</a></li>
            
                <li data-name="plastic.modules.data.AskJson#setDataObj"><a href="plastic.modules.data.AskJson.html#setDataObj">setDataObj</a></li>
            
                <li data-name="plastic.modules.data.AskJson#validate"><a href="plastic.modules.data.AskJson.html#validate">validate</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="plastic.modules.data.SparqlJson">
            <span class="title">
                <a href="plastic.modules.data.SparqlJson.html">plastic.modules.data.SparqlJson</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.modules.data.SparqlJson#dataObj"><a href="plastic.modules.data.SparqlJson.html#dataObj">dataObj</a></li>
            
                <li data-name="plastic.modules.data.SparqlJson#validationSchema"><a href="plastic.modules.data.SparqlJson.html#validationSchema">validationSchema</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="plastic.modules.data.SparqlJson#execute"><a href="plastic.modules.data.SparqlJson.html#execute">execute</a></li>
            
                <li data-name="plastic.modules.data.SparqlJson#setDataObj"><a href="plastic.modules.data.SparqlJson.html#setDataObj">setDataObj</a></li>
            
                <li data-name="plastic.modules.data.SparqlJson#validate"><a href="plastic.modules.data.SparqlJson.html#validate">validate</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="plastic.modules.display.SimpleTable">
            <span class="title">
                <a href="plastic.modules.display.SimpleTable.html">plastic.modules.display.SimpleTable</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.modules.display.SimpleTable#displayEl"><a href="plastic.modules.display.SimpleTable.html#displayEl">displayEl</a></li>
            
                <li data-name="plastic.modules.display.SimpleTable#el"><a href="plastic.modules.display.SimpleTable.html#el">el</a></li>
            
                <li data-name="plastic.modules.display.SimpleTable#elAttr"><a href="plastic.modules.display.SimpleTable.html#elAttr">elAttr</a></li>
            
                <li data-name="plastic.modules.display.SimpleTable#validationSchema"><a href="plastic.modules.display.SimpleTable.html#validationSchema">validationSchema</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="plastic.modules.display.SimpleTable#execute"><a href="plastic.modules.display.SimpleTable.html#execute">execute</a></li>
            
                <li data-name="plastic.modules.display.SimpleTable#setElAttr"><a href="plastic.modules.display.SimpleTable.html#setElAttr">setElAttr</a></li>
            
                <li data-name="plastic.modules.display.SimpleTable#validate"><a href="plastic.modules.display.SimpleTable.html#validate">validate</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="plastic.modules.query.Ask">
            <span class="title">
                <a href="plastic.modules.query.Ask.html">plastic.modules.query.Ask</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.modules.query.Ask#queryObj"><a href="plastic.modules.query.Ask.html#queryObj">queryObj</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="plastic.modules.query.Ask#execute"><a href="plastic.modules.query.Ask.html#execute">execute</a></li>
            
                <li data-name="plastic.modules.query.Ask#setQueryObj"><a href="plastic.modules.query.Ask.html#setQueryObj">setQueryObj</a></li>
            
                <li data-name="plastic.modules.query.Ask#validate"><a href="plastic.modules.query.Ask.html#validate">validate</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="plastic.modules.query.Sparql">
            <span class="title">
                <a href="plastic.modules.query.Sparql.html">plastic.modules.query.Sparql</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="plastic.modules.query.Sparql#queryObj"><a href="plastic.modules.query.Sparql.html#queryObj">queryObj</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="plastic.modules.query.Sparql#execute"><a href="plastic.modules.query.Sparql.html#execute">execute</a></li>
            
                <li data-name="plastic.modules.query.Sparql#setQueryObj"><a href="plastic.modules.query.Sparql.html#setQueryObj">setQueryObj</a></li>
            
                <li data-name="plastic.modules.query.Sparql#validate"><a href="plastic.modules.query.Sparql.html#validate">validate</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="Element.js.html">Source: core/Element.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
 * Plastic Element Prototype
 *
 * This creates a new plastic.js element and executes all processes needed to get the final result
 *
 * @example
 * plastic.elements[i] = new plastic.Element(el);
 *
 * @constructor
 */
plastic.Element = function(el) {

    /**
     * DOM Element
     *
     * @type {{}}
     */
    this.el = el;

    /**
     * plastic.js ElementAttibutes Object (Instance)
     *
     * @type {plastic.ElementAttributes}
     */
    this.attributes = new plastic.ElementAttributes(el);

    /**
     * Link to Attributes Object
     *
     * If you need easy access to the current Attributes Object, use this.
     *
     * @type {{}}
     */
    this.attr = this.attributes.attr;

    /**
     * Element Query Module Instance
     *
     * @type {{}}
     */
    this.queryModule = undefined;

    /**
     * Element Data Module Instance
     *
     * @type {{}}
     */
    this.dataModule = undefined;

    /**
     * Element Display Module Instance
     *
     * @type {{}}
     */
    this.displayModule = undefined;

    // Auto Execute Process
    this.exec();

};

plastic.Element.prototype = {

    /**
     * Get DOM Element within PlasticElement Container
     * @returns {Object}
     */
    getEl:function() {
        return this.el;
    },

    /**
     * Get DOM Element within PlasticElement Container
     * @param el
     */
    setEl:function(el) {
        this.el = el;
    },

    /**
     * Get plastic.js Element Attributes
     * @returns {Object}
     */
    getAttr:function() {
        return this.attr;
    },

    /**
     * Executes the processing of the plastic.element
     * This starts
     *
     * @todo Introduce Error State: Stop further Processing if there are Exceptions
     */
    exec: function() {

        console.info('plastic.processElement();');

        /** Asynchronous Mode */
        var async = false;
        var error = false;
        var request;
        var self = this;

        this.createMsgContainer(this.el);
        this.createDisplayContainer(this.el);


        //////////////////////////////////////////
        // CALLING QUERY PARSER                 //
        //////////////////////////////////////////

        if (this.attr.query) { // OPTIONAL
            this.callQueryParser();
        }


        //////////////////////////////////////////
        // GETTING DATA VIA URL                 //
        //////////////////////////////////////////

        if (this.attr.data && this.attr.data.url) {

            var start = (new Date()).getTime();
            async = true;

            console.log('Getting Data from URL via AJAX: ' + this.attr.data.url);

            request = $.ajax({
                url: this.attr.data.url,
                dataType: 'json',
                timeout: plastic.options.timeout,
                success: function(data) {
                    "use strict";
                    self.setRawData(data);
                },
                error: function() {
                    plastic.msg('Could not get Data from URL &lt;a href="' + self.attr.data.url + '">' + self.attr.data.url + '&lt;/a>', "error", self.el );
                    error = true;
                }
            });

        }


        //////////////////////////////////////////
        // CALLING THE DATA & DISPLAY MODULE    //
        //////////////////////////////////////////

        if (async) {

            // On Request complete
            request.complete(function(data) {

                console.log('Received asynchronous data.');
                var diff = (new Date()).getTime() - start;
                console.log("Request completed in " + diff + 'ms');

                if (!error) {
                    self.callDataParser();
                }
                if (!error) {
                    self.callDisplayModule();
                }
            });

        } else {

            console.log('Received Synchronous Data');

            self.callDataParser();
            self.callDisplayModule();

        }


    },


    /**
     * Sets the Raw Data
     *
     * @param data
     */
    setRawData: function(data) {
        "use strict";

        if (data !== null && typeof data === 'object') {
            this.attr.data.raw = data;
        } else {
            this.attr.data.raw = $.parseJSON(data);
        }

    },

    /**
     * Helper Functin which creates a HTML Element for use as a Message Container
     */
    createMsgContainer: function() {
        "use strict";

        this.el.css('position', 'relative');

        this.el.append('&lt;div class="plastic-js-msg">&lt;/div>');
        var msgEl = this.el.find('.plastic-js-msg');
        msgEl
            .height(this.el.height())
            .width(this.el.width())
        ;
    },

    /**
     * Helper Functin which creates a HTML Element for use as a Display Container
     */
    createDisplayContainer: function() {
        "use strict";
        console.info('plastic.prepareCanvas();');

        this.el.append('&lt;div class="plastic-js-display">&lt;/div>');
        var displayEl = this.el.find('.plastic-js-display');
        displayEl
            .height(this.el.height())
            .width(this.el.width())
        ;
    },

    /**
     * Helper Function to call the Query Parser Module
     */
    callQueryParser: function() {

        console.info('processElement.callQueryParser(); ' + this.attr.query.type);

        // Look for data parser module in the registry
        var moduleInfo = plastic.modules.registry.get('query',[this.attr.query.type]);
        var Module = plastic.modules.query[moduleInfo.className];

        if (Module) {

            console.log('Using Parser: ' + moduleInfo.className);

            this.queryModule = new Module(this.attr.query);
            this.validateModule(this.queryModule, this.attr.query);
            this.attr.data = this.queryModule.execute();

        } else {
            plastic.msg('Query Parser Module ' + this.attr.query.type + ' not found.', 'error', this.el);
        }

    },

    /**
     * Helper Function to call the Data Parser Module
     */
    callDataParser: function() {

        console.info('processElement.callDataParser()');

        // Look for data parser module in the registry
        var moduleInfo = plastic.modules.registry.get('data',[this.attr.data.parser]);
        var Module = plastic.modules.data[moduleInfo.className];

        if (Module) {

            console.log('Using Parser: ' + moduleInfo.className);

            console.dir(this.attr);

            this.dataModule = new Module(this.attr.data);
            this.validateModule(this.dataModule, this.attr.data.raw);
            this.attr.data = this.dataModule.execute();

        } else {
            plastic.msg('Data Parser Module ' + this.attr.data.parser + ' not found.', 'error', this.el);
        }

    },

    /**
     * Helper Function to call the Display Module
     *
     * @todo: Manage Dependencies
     */
    callDisplayModule: function() {

        console.info('plastic.Element.callDisplayModule()');

        // Look for data parser module in the registry
        var moduleInfo = plastic.modules.registry.get('display',[this.attr.options.display.module]);
        var Module = plastic.modules.display[moduleInfo.className];

        if (Module) {

            console.log('Using Display Module: ' + moduleInfo.className);

            this.displayModule = new Module(this.el, this.attr);
            this.validateModule(this.displayModule, this.attr.options.display);
            this.displayModule.execute();

        } else {
            plastic.msg('Display Module ' + this.attr.data.parser + ' not found.', 'error', this.el);
        }

    },

    /**
     * Validation Helper Function
     *
     * This calls two kinds of validations:
     * * General Validation: Validates custom Logic
     * * Schema Validation: Validates the Data Structure of the incoming data
     *
     * @param {{}} module   plastic.js Module
     * @param {{}} data     Data Object that is to be validated
     */
    validateModule: function(module, data) {

        if (module.validate) {
            var validationErrors = module.validate();

            // validation was successful
            if (validationErrors) {
                console.dir(validationErrors);
                throw new Error('Validation Error!');
            }
        }

        if (module.validationSchema) {

            console.log('Schema Validation');

            var env = jjv();
            env.addSchema('data', module.validationSchema);
            var schemaErrors = env.validate('data', data);

            // validation was successful
            if (schemaErrors) {
                console.dir(schemaErrors);
                throw new Error('Data Structure invalid!');
            }
        }
    }

};
</code></pre>
        </article>
    </section>





        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Mon May 05 2014 14:47:59 GMT+0200 (MESZ)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
